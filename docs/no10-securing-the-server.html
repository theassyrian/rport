<!DOCTYPE html>
<html lang="en-DE">
  <head>
    <link rel="icon" type="image/png" sizes="16x16" href="/favicon/favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="/favicon/favicon-32x32.png"><link rel="manifest" href="/favicon/site.webmanifest"><meta name="application-name" content="docs"><meta name="apple-mobile-web-app-title" content="docs"><meta name="apple-mobile-web-app-status-bar-style" content="black"><link rel="apple-touch-icon" href="/favicon/apple-touch-icon.png"><meta name="msapplication-TileColor" content="#0075ec"><meta name="theme-color" content="#0075ec"><title>Securing the rport server | rport</title><meta name="description" content="Rport helps you to manage your remote servers without the hassle of VPNs, chained SSH connections, jump-hosts, or the use of commercial tools like TeamViewer and its clones."><meta charset="utf-8"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="generator" content="VuePress 2.0.0-beta.22">
    <link rel="preload" href="/assets/js/runtime~app.5ee4de28.js" as="script"><link rel="preload" href="/assets/css/styles.f0beda5c.css" as="style"><link rel="preload" href="/assets/js/149.ce195099.js" as="script"><link rel="preload" href="/assets/js/app.cd7c81f6.js" as="script">
    <link rel="stylesheet" href="/assets/css/styles.f0beda5c.css">
  </head>
  <body>
    <div id="app"><!--[--><div class="theme-container"><header class="navbar"><div class="toggle-sidebar-button"><svg class="icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div><span><a href="/" class=""><img class="logo" src="/logo/rport-img-text.svg" alt="rport"><span class="site-name can-hide">rport</span></a></span><div class="navbar-links-wrapper" style=""><!--[--><!--]--><nav class="navbar-links can-hide"><!--[--><div class="navbar-links-item"><a href="/docs/" class="nav-link router-link-active" aria-label="Documentation"><!--[--><!--]--> Documentation <!--[--><!--]--></a></div><div class="navbar-links-item"><a class="nav-link external" href="https://github.com/cloudradar-monitoring/rport/discussions" rel="noopener noreferrer" target="_blank" aria-label="Help"><!--[--><!--]--> Help <span><svg class="icon outbound" xmlns="http://www.w3.org/2000/svg" ariahidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><!--[--><span class="sr-only">open in new window</span><!--]--></span><!--[--><!--]--></a></div><div class="navbar-links-item"><a class="nav-link external" href="https://kb.rport.io" rel="noopener noreferrer" target="_blank" aria-label="Wiki"><!--[--><!--]--> Wiki <span><svg class="icon outbound" xmlns="http://www.w3.org/2000/svg" ariahidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><!--[--><span class="sr-only">open in new window</span><!--]--></span><!--[--><!--]--></a></div><div class="navbar-links-item"><a class="nav-link external" href="https://github.com/cloudradar-monitoring/rport/releases" rel="noopener noreferrer" target="_blank" aria-label="Download"><!--[--><!--]--> Download <span><svg class="icon outbound" xmlns="http://www.w3.org/2000/svg" ariahidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><!--[--><span class="sr-only">open in new window</span><!--]--></span><!--[--><!--]--></a></div><div class="navbar-links-item"><a class="nav-link external" href="https://github.com/cloudradar-monitoring/rport" rel="noopener noreferrer" target="_blank" aria-label="Github-Repo"><!--[--><!--]--> Github-Repo <span><svg class="icon outbound" xmlns="http://www.w3.org/2000/svg" ariahidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><!--[--><span class="sr-only">open in new window</span><!--]--></span><!--[--><!--]--></a></div><!--]--></nav><!--[--><!--]--><button class="toggle-dark-button"><svg style="" class="icon" focusable="false" viewBox="0 0 32 32"><path d="M16 12.005a4 4 0 1 1-4 4a4.005 4.005 0 0 1 4-4m0-2a6 6 0 1 0 6 6a6 6 0 0 0-6-6z" fill="currentColor"></path><path d="M5.394 6.813l1.414-1.415l3.506 3.506L8.9 10.318z" fill="currentColor"></path><path d="M2 15.005h5v2H2z" fill="currentColor"></path><path d="M5.394 25.197L8.9 21.691l1.414 1.415l-3.506 3.505z" fill="currentColor"></path><path d="M15 25.005h2v5h-2z" fill="currentColor"></path><path d="M21.687 23.106l1.414-1.415l3.506 3.506l-1.414 1.414z" fill="currentColor"></path><path d="M25 15.005h5v2h-5z" fill="currentColor"></path><path d="M21.687 8.904l3.506-3.506l1.414 1.415l-3.506 3.505z" fill="currentColor"></path><path d="M15 2.005h2v5h-2z" fill="currentColor"></path></svg><svg style="display:none;" class="icon" focusable="false" viewBox="0 0 32 32"><path d="M13.502 5.414a15.075 15.075 0 0 0 11.594 18.194a11.113 11.113 0 0 1-7.975 3.39c-.138 0-.278.005-.418 0a11.094 11.094 0 0 1-3.2-21.584M14.98 3a1.002 1.002 0 0 0-.175.016a13.096 13.096 0 0 0 1.825 25.981c.164.006.328 0 .49 0a13.072 13.072 0 0 0 10.703-5.555a1.01 1.01 0 0 0-.783-1.565A13.08 13.08 0 0 1 15.89 4.38A1.015 1.015 0 0 0 14.98 3z" fill="currentColor"></path></svg></button><!----></div></header><div class="sidebar-mask"></div><aside class="sidebar"><nav class="navbar-links"><!--[--><div class="navbar-links-item"><a href="/docs/" class="nav-link router-link-active" aria-label="Documentation"><!--[--><!--]--> Documentation <!--[--><!--]--></a></div><div class="navbar-links-item"><a class="nav-link external" href="https://github.com/cloudradar-monitoring/rport/discussions" rel="noopener noreferrer" target="_blank" aria-label="Help"><!--[--><!--]--> Help <span><svg class="icon outbound" xmlns="http://www.w3.org/2000/svg" ariahidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><!--[--><span class="sr-only">open in new window</span><!--]--></span><!--[--><!--]--></a></div><div class="navbar-links-item"><a class="nav-link external" href="https://kb.rport.io" rel="noopener noreferrer" target="_blank" aria-label="Wiki"><!--[--><!--]--> Wiki <span><svg class="icon outbound" xmlns="http://www.w3.org/2000/svg" ariahidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><!--[--><span class="sr-only">open in new window</span><!--]--></span><!--[--><!--]--></a></div><div class="navbar-links-item"><a class="nav-link external" href="https://github.com/cloudradar-monitoring/rport/releases" rel="noopener noreferrer" target="_blank" aria-label="Download"><!--[--><!--]--> Download <span><svg class="icon outbound" xmlns="http://www.w3.org/2000/svg" ariahidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><!--[--><span class="sr-only">open in new window</span><!--]--></span><!--[--><!--]--></a></div><div class="navbar-links-item"><a class="nav-link external" href="https://github.com/cloudradar-monitoring/rport" rel="noopener noreferrer" target="_blank" aria-label="Github-Repo"><!--[--><!--]--> Github-Repo <span><svg class="icon outbound" xmlns="http://www.w3.org/2000/svg" ariahidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><!--[--><span class="sr-only">open in new window</span><!--]--></span><!--[--><!--]--></a></div><!--]--></nav><!--[--><!--]--><ul class="sidebar-links"><!--[--><!--[--><p class="sidebar-heading sidebar-item active">Documentation</p><ul class=""><li><!--[--><a href="/docs/" class="nav-link router-link-active sidebar-item" aria-label="Quick Start"><!--[--><!--]--> Quick Start <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a href="/docs/no01-on-demand-tunnels.html" class="nav-link sidebar-item" aria-label="On-demand tunnels using the API"><!--[--><!--]--> On-demand tunnels using the API <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a href="/docs/no02-api-auth.html" class="nav-link sidebar-item" aria-label="API Authentication"><!--[--><!--]--> API Authentication <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a href="/docs/no03-client-auth.html" class="nav-link sidebar-item" aria-label="Client Authentication"><!--[--><!--]--> Client Authentication <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a href="/docs/no04-client-groups.html" class="nav-link sidebar-item" aria-label="Client Groups"><!--[--><!--]--> Client Groups <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a href="/docs/no05-client-on-other-os.html" class="nav-link sidebar-item" aria-label="Install and run a rport client"><!--[--><!--]--> Install and run a rport client <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a href="/docs/no06-command-execution.html" class="nav-link sidebar-item" aria-label="Command execution"><!--[--><!--]--> Command execution <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a href="/docs/no07-frontend.html" class="nav-link sidebar-item" aria-label="Rport Frontend"><!--[--><!--]--> Rport Frontend <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a href="/docs/no08-https-howto.html" class="nav-link sidebar-item" aria-label="Securing the Rportd API with HTTPS"><!--[--><!--]--> Securing the Rportd API with HTTPS <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a href="/docs/no09-managing-tunnels.html" class="nav-link sidebar-item" aria-label="Managing tunnels"><!--[--><!--]--> Managing tunnels <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/docs/no10-securing-the-server.html" class="router-link-active router-link-exact-active nav-link router-link-active sidebar-item active" aria-label="Securing the rport server"><!--[--><!--]--> Securing the rport server <!--[--><!--]--></a><ul class="sidebar-sub-items"><li><!--[--><a aria-current="page" href="/docs/no10-securing-the-server.html#client-connection-listener" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="Client Connection Listener"><!--[--><!--]--> Client Connection Listener <!--[--><!--]--></a><ul class="sidebar-sub-items"><li><!--[--><a aria-current="page" href="/docs/no10-securing-the-server.html#the-client-connection-listener-is-secured-by-default" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="The client connection listener is secured by default"><!--[--><!--]--> The client connection listener is secured by default <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/docs/no10-securing-the-server.html#using-fail2ban-for-additional-security" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="Using fail2ban for additional security"><!--[--><!--]--> Using fail2ban for additional security <!--[--><!--]--></a><!----><!--]--></li></ul><!--]--></li><li><!--[--><a aria-current="page" href="/docs/no10-securing-the-server.html#securing-the-api" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="Securing the API"><!--[--><!--]--> Securing the API <!--[--><!--]--></a><!----><!--]--></li></ul><!--]--></li><li><!--[--><a href="/docs/no11-multi-tenancy.html" class="nav-link sidebar-item" aria-label="Multi tenancy"><!--[--><!--]--> Multi tenancy <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a href="/docs/no12-user.html" class="nav-link sidebar-item" aria-label="Users"><!--[--><!--]--> Users <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a href="/docs/no13-vault.html" class="nav-link sidebar-item" aria-label="Vault"><!--[--><!--]--> Vault <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a href="/docs/no14-scripts.html" class="nav-link sidebar-item" aria-label="Scripts"><!--[--><!--]--> Scripts <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a href="/docs/no15-messaging.html" class="nav-link sidebar-item" aria-label="Messaging"><!--[--><!--]--> Messaging <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a href="/docs/no16-update-status.html" class="nav-link sidebar-item" aria-label="Supervising the update status (patch level)"><!--[--><!--]--> Supervising the update status (patch level) <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a href="/docs/no17-monitoring.html" class="nav-link sidebar-item" aria-label="Monitoring"><!--[--><!--]--> Monitoring <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a href="/docs/no18-file-upload.html" class="nav-link sidebar-item" aria-label="File upload"><!--[--><!--]--> File upload <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a href="/docs/no18-novnc-proxy.html" class="nav-link sidebar-item" aria-label="noVNC-Proxy"><!--[--><!--]--> noVNC-Proxy <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a href="/docs/no19-rdp-proxy.html" class="nav-link sidebar-item" aria-label="RDP-Proxy"><!--[--><!--]--> RDP-Proxy <!--[--><!--]--></a><!----><!--]--></li></ul><!--]--><!--]--></ul><!--[--><!--]--></aside><main class="page"><!--[--><!--]--><div class="theme-default-content"><!--[--><h1 id="securing-the-rport-server" tabindex="-1"><a class="header-anchor" href="#securing-the-rport-server" aria-hidden="true">#</a> Securing the rport server</h1><p>Your rport server usually exposes two TCP ports to the public internet:</p><ul><li>one for the client connections</li><li>one for the API and the web frontend</li></ul><p>Both require authentication and unless you use weak passwords you are safe. But even if login attempts are prevented on the HTTP level they produce some load on your server.</p><p>Learn more about the default security measures and how to add a second level of security using <a href="https://www.fail2ban.org/" target="_blank" rel="noopener noreferrer">fail2ban<span><svg class="icon outbound" xmlns="http://www.w3.org/2000/svg" ariahidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><!--[--><span class="sr-only">open in new window</span><!--]--></span></a>.</p><h2 id="client-connection-listener" tabindex="-1"><a class="header-anchor" href="#client-connection-listener" aria-hidden="true">#</a> Client Connection Listener</h2><h3 id="the-client-connection-listener-is-secured-by-default" tabindex="-1"><a class="header-anchor" href="#the-client-connection-listener-is-secured-by-default" aria-hidden="true">#</a> The client connection listener is secured by default</h3><p>By default, the following options are activated for the client connection listener.</p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>## Protect your server against password guessing.
## Force clients to wait N seconds (float) between unsuccessful login attempts.
## This is per client auth id.
## A message like
##    &#39;client-listener: Failed login attempt for client auth id &quot;abc&quot;, forcing to wait for {client_login_wait}s ({ip})&#39;
## is logged to the info log.
## Consider changing the log_level to &#39;info&#39; to trace failed login attempts.
## Learn more https://oss.rport.io/docs/no10-securing-the-server.html
## Defaults: 2.0
#client_login_wait = 2.0

## After {max_failed_login} consecutive failed login-in attempts ban the source IP address for {ban_time} seconds.
## HTTP Status 423 is returned.
## A message like
##     &#39;Maximum of {max_failed_login} login attempts reached. Visitor ({remote-ip}) banned. Ban expiry: 2021-04-16T11:22:26+00:00&#39;
## is logged to the info log.
## Banning happens on HTTP level.
## Consider banning on network level using fail2ban.
## Learn more https://oss.rport.io/docs/no10-securing-the-server.html
## Defaults: max_failed_login = 5, ban_time = 3600
#max_failed_login = 5
#ban_time = 3600
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br></div></div><p>These are good settings to protect your server against password guessing. The counters for failed logins are constantly increasing and only reset by a successful login or a server restart.</p><p>For example, if a client fails to log in for the fifth time, any login attempts of the IP address are blocked for one hour. If there are more clients on the same network with correct credentials but sharing common internet access and these clients are restarted, they are banned too.</p><div class="custom-container warning"><p class="custom-container-title">WARNING</p><p>Because rejecting connections on failed logins is handled properly by the server, they are not considered an error and not logged to the log file when you are on the <code>error</code> log level. Consider changing the <code>log_level</code> to <code>info</code> to trace failed logins and to eventually activate fail2ban.</p></div><h3 id="using-fail2ban-for-additional-security" tabindex="-1"><a class="header-anchor" href="#using-fail2ban-for-additional-security" aria-hidden="true">#</a> Using fail2ban for additional security</h3><h4 id="ban-password-guesser" tabindex="-1"><a class="header-anchor" href="#ban-password-guesser" aria-hidden="true">#</a> Ban password guesser</h4><h4 id="ban-scanners" tabindex="-1"><a class="header-anchor" href="#ban-scanners" aria-hidden="true">#</a> Ban scanners</h4><p>After a short period, you will notice HTTP requests to arbitrary files and folders on the client connect port that are answered with HTTP 404. The internet is full of scanners searching for vulnerable web applications. You can safely ban any IP address that produces HTTP 404. A rport client will never do this.</p><p>Search your log file for the following pattern: <code>egrep &quot; 404 [0-9]+\w+ \(.*\)&quot; /var/log/rport/rportd.log</code></p><h4 id="fail2ban-configuration" tabindex="-1"><a class="header-anchor" href="#fail2ban-configuration" aria-hidden="true">#</a> Fail2ban configuration</h4><div class="custom-container tip"><p class="custom-container-title">Remember</p><p>All fail2ban rules require running rport with <code>log_level = &#39;info&#39;</code>.</p></div><p>To create rules and filters to ban both, password guessers and scanners, proceed with the following setup.</p><p>A fail2ban filter <code>/etc/fail2ban/filter.d/rportd-client-connect.conf</code> can look like this.</p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code># Fail2Ban filter for rportd client connect
[Definition]
# Identify scanners
failregex = 404 [0-9]+\w+ \(&lt;HOST&gt;\)
# Identify password guesser
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>Test the definition with <code>fail2ban-regex /var/log/rport/rportd.log /etc/fail2ban/filter.d/rport-client-connect.conf</code> It should output something like</p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>Lines: 16900 lines, 0 ignored, 755 matched, 16145 missed
[processed in 1.04 sec]
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>That means fail2ban has found 755 requests that will be banned.</p><p>Create a ban action in <code>/etc/fail2ban/jail.d/rportd-client-connect.conf</code>. Change <code>port</code> to the port your rportd is listening for client connections. <code>grep &quot;url =&quot; /etc/rport/rportd.conf </code></p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code># service name
[rportd-client-connect]
# turn on /off
enabled  = true
# ports to ban (numeric or text)
port     = 8080
# filter from previous step
filter   = rportd-client-connect
# file to parse
logpath  = /var/log/rport/rportd.log
# ban rule:
# ban all IPs that have created two 404 request during the last 20 seconds for 1hour
maxretry = 2
findtime = 20
# ban on 10 minutes
bantime = 3600
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br></div></div><p>Restart fail2ban to activate the new configuration with <code>service fail2ban restart</code> and check the status.</p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>root@localhost:~# fail2ban-client status
Status
|- Number of jail:	2
`- Jail list:	rportd-client-connect, sshd
fail2ban-server[1905]: Server ready
root@localhost:~# fail2ban-client status
Status
|- Number of jail:	2
`- Jail list:	rportd-client-connect, sshd
root@localhost:~# fail2ban-client status rportd-client-connect
Status for the jail: rportd-client-connect
|- Filter
|  |- Currently failed:	0
|  |- Total failed:	0
|  `- File list:	/var/log/rport/rportd.log
`- Actions
   |- Currently banned:	0
   |- Total banned:	0
   `- Banned IP list:	
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br></div></div><div class="custom-container warning"><p class="custom-container-title">WARNING</p><p>Fail2ban ships with a lot of default rules and the SSH is enabled by default. To enable fail2ban only for rportd and to disable the ssh rule, make sure only rportd rules are in <code>/etc/fail2ban/jail.d/</code>. Either delete <code>/etc/fail2ban/jail.d/defaults-debian.conf</code> or open the file and comment out all lines. Use <code>fail2ban-client status</code> to verify which rules are active.</p></div><h2 id="securing-the-api" tabindex="-1"><a class="header-anchor" href="#securing-the-api" aria-hidden="true">#</a> Securing the API</h2><p>@todo: Finish this chapter.</p><!--]--></div><footer class="page-meta"><!----><!----><!----></footer><nav class="page-nav"><p class="inner"><span class="prev"> ← <a href="/docs/no09-managing-tunnels.html" class="nav-link" aria-label="Managing tunnels"><!--[--><!--]--> Managing tunnels <!--[--><!--]--></a></span><span class="next"><a href="/docs/no11-multi-tenancy.html" class="nav-link" aria-label="Multi tenancy"><!--[--><!--]--> Multi tenancy <!--[--><!--]--></a> → </span></p></nav><!--[--><!--]--></main></div><!----><div class="ga-consent"><p> By clicking &quot;Accept&quot;, you agree that we store Cookies from Google to provide services and analyse traffic. </p><button type="button" class="button primary">Accept</button></div><!--]--></div>
    <script src="/assets/js/runtime~app.5ee4de28.js" defer></script><script src="/assets/js/149.ce195099.js" defer></script><script src="/assets/js/app.cd7c81f6.js" defer></script>
  </body>
</html>
